---
title: "p8105_hw5_rc3520"
author: "Ruyi Chen"
date: "2023-11-14"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(broom)
```
#Problem 1
```{r}
homicide = 
  read_csv("data/homicide-data.csv") |>
  janitor::clean_names()|>
  mutate(city_state = paste(city, state, sep = ","))
view(homicide)
```


```{r}
homicide_city_state =
  homicide |>
  group_by(city_state, disposition) |>
  count(disposition) |>
  pivot_wider(
    names_from = disposition,
    values_from = n
  ) |>
  janitor::clean_names()|>
  mutate_all(~coalesce(., 0))|>
  mutate(total_homicide = closed_without_arrest + open_no_arrest + closed_by_arrest,
    unsolved_homicide = closed_without_arrest + open_no_arrest)
homicide_city_state
```

```{r}
baltimore_homicide =
  homicide_city_state |>
  filter(city_state == "Baltimore,MD")
baltimore_homicide

prop_test_result =
  prop.test(
  x = baltimore_homicide$unsolved_homicide,
  n = baltimore_homicide$total_homicide
  ) |>
  broom::tidy() 

prop_test_result |>
  knitr::kable()
```
##The proportion of homicides that are unsolved in Baltimore is around 64.55607% (CI: 62.75625%, 66.31599%).


