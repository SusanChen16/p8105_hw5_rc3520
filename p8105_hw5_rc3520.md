p8105_hw5_rc3520
================
Ruyi Chen
2023-11-14

\#Problem 1

``` r
homicide = 
  read_csv("data/homicide-data.csv") |>
  janitor::clean_names()|>
  mutate(city_state = paste(city, state, sep = ","))
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
view(homicide)
```

``` r
homicide_city_state =
  homicide |>
  group_by(city_state, disposition) |>
  count(disposition) |>
  pivot_wider(
    names_from = disposition,
    values_from = n
  ) |>
  janitor::clean_names()|>
  mutate_all(~coalesce(., 0))|>
  mutate(total_homicide = closed_without_arrest + open_no_arrest + closed_by_arrest,
    unsolved_homicide = closed_without_arrest + open_no_arrest)
```

    ## `mutate_all()` ignored the following grouping variables:
    ## • Column `city_state`
    ## ℹ Use `mutate_at(df, vars(-group_cols()), myoperation)` to silence the message.

``` r
homicide_city_state
```

    ## # A tibble: 51 × 6
    ## # Groups:   city_state [51]
    ##    city_state     closed_by_arrest closed_without_arrest open_no_arrest
    ##    <chr>                     <dbl>                 <dbl>          <dbl>
    ##  1 Albuquerque,NM              232                    52             94
    ##  2 Atlanta,GA                  600                    58            315
    ##  3 Baltimore,MD               1002                   152           1673
    ##  4 Baton Rouge,LA              228                    16            180
    ##  5 Birmingham,AL               453                    64            283
    ##  6 Boston,MA                   304                     0            310
    ##  7 Buffalo,NY                  202                     8            311
    ##  8 Charlotte,NC                481                    44            162
    ##  9 Chicago,IL                 1462                   387           3686
    ## 10 Cincinnati,OH               385                    49            260
    ## # ℹ 41 more rows
    ## # ℹ 2 more variables: total_homicide <dbl>, unsolved_homicide <dbl>

``` r
baltimore_homicide =
  homicide_city_state |>
  filter(city_state == "Baltimore,MD")
baltimore_homicide
```

    ## # A tibble: 1 × 6
    ## # Groups:   city_state [1]
    ##   city_state   closed_by_arrest closed_without_arrest open_no_arrest
    ##   <chr>                   <dbl>                 <dbl>          <dbl>
    ## 1 Baltimore,MD             1002                   152           1673
    ## # ℹ 2 more variables: total_homicide <dbl>, unsolved_homicide <dbl>

``` r
prop_test_result =
  prop.test(
  x = baltimore_homicide$unsolved_homicide,
  n = baltimore_homicide$total_homicide
  ) |>
  broom::tidy() 

prop_test_result |>
  knitr::kable()
```

|  estimate | statistic | p.value | parameter |  conf.low | conf.high | method                                               | alternative |
|----------:|----------:|--------:|----------:|----------:|----------:|:-----------------------------------------------------|:------------|
| 0.6455607 |   239.011 |       0 |         1 | 0.6275625 | 0.6631599 | 1-sample proportions test with continuity correction | two.sided   |

\##The proportion of homicides that are unsolved in Baltimore is around
64.55607% (CI: 62.75625%, 66.31599%).

``` r
prop_test = function (city_name) {
    prop.test(
  x = homicide_city_state$unsolved_homicide[homicide_city_state$city_state == city_name ],
  n = homicide_city_state$total_homicide[homicide_city_state$city_state == city_name ]
  ) |>
    broom::tidy()}

purrr::map(pull(homicide_city_state, city_state), prop_test)
```

    ## Warning in prop.test(x =
    ## homicide_city_state$unsolved_homicide[homicide_city_state$city_state == :
    ## Chi-squared approximation may be incorrect

    ## [[1]]
    ## # A tibble: 1 × 8
    ##   estimate statistic   p.value parameter conf.low conf.high method   alternative
    ##      <dbl>     <dbl>     <dbl>     <int>    <dbl>     <dbl> <chr>    <chr>      
    ## 1    0.386      19.1 0.0000123         1    0.337     0.438 1-sampl… two.sided  
    ## 
    ## [[2]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.383      52.5 4.32e-13         1    0.353     0.415 1-sample… two.sided  
    ## 
    ## [[3]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.646      239. 6.46e-54         1    0.628     0.663 1-sample… two.sided  
    ## 
    ## [[4]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.462      2.27   0.132         1    0.414     0.511 1-sample … two.sided  
    ## 
    ## [[5]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.434      13.8 0.000205         1    0.399     0.469 1-sample… two.sided  
    ## 
    ## [[6]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.505    0.0407   0.840         1    0.465     0.545 1-sample … two.sided  
    ## 
    ## [[7]]
    ## # A tibble: 1 × 8
    ##   estimate statistic     p.value parameter conf.low conf.high method alternative
    ##      <dbl>     <dbl>       <dbl>     <int>    <dbl>     <dbl> <chr>  <chr>      
    ## 1    0.612      25.8 0.000000373         1    0.569     0.654 1-sam… two.sided  
    ## 
    ## [[8]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.300      109. 1.41e-25         1    0.266     0.336 1-sample… two.sided  
    ## 
    ## [[9]]
    ## # A tibble: 1 × 8
    ##   estimate statistic   p.value parameter conf.low conf.high method   alternative
    ##      <dbl>     <dbl>     <dbl>     <int>    <dbl>     <dbl> <chr>    <chr>      
    ## 1    0.736     1231. 1.28e-269         1    0.724     0.747 1-sampl… two.sided  
    ## 
    ## [[10]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.445      8.11 0.00441         1    0.408     0.483 1-sample … two.sided  
    ## 
    ## [[11]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.530      3.90  0.0484         1    0.500     0.560 1-sample … two.sided  
    ## 
    ## [[12]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.481      2.15   0.143         1    0.456     0.506 1-sample … two.sided  
    ## 
    ## [[13]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.542      2.00   0.157         1    0.485     0.598 1-sample … two.sided  
    ## 
    ## [[14]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.588      78.3 9.03e-19         1    0.569     0.608 1-sample… two.sided  
    ## 
    ## [[15]]
    ## # A tibble: 1 × 8
    ##   estimate statistic   p.value parameter conf.low conf.high method   alternative
    ##      <dbl>     <dbl>     <dbl>     <int>    <dbl>     <dbl> <chr>    <chr>      
    ## 1    0.366      19.3 0.0000111         1    0.310     0.426 1-sampl… two.sided  
    ## 
    ## [[16]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.464      2.63   0.105         1    0.422     0.507 1-sample … two.sided  
    ## 
    ## [[17]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.347      45.0 1.99e-11         1    0.305     0.391 1-sample… two.sided  
    ## 
    ## [[18]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.507     0.628   0.428         1    0.489     0.526 1-sample … two.sided  
    ## 
    ## [[19]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.449      13.4 0.000254         1    0.422     0.477 1-sample… two.sided  
    ## 
    ## [[20]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.511     0.535   0.464         1    0.482     0.540 1-sample … two.sided  
    ## 
    ## [[21]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.408      39.6 3.16e-10         1    0.380     0.437 1-sample… two.sided  
    ## 
    ## [[22]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.414      40.3 2.14e-10         1    0.388     0.441 1-sample… two.sided  
    ## 
    ## [[23]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.413      11.2 0.000828         1    0.363     0.464 1-sample… two.sided  
    ## 
    ## [[24]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.490     0.858   0.354         1    0.469     0.511 1-sample … two.sided  
    ## 
    ## [[25]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.453      4.88  0.0272         1    0.412     0.495 1-sample … two.sided  
    ## 
    ## [[26]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.319      198. 6.88e-45         1    0.296     0.343 1-sample… two.sided  
    ## 
    ## [[27]]
    ## # A tibble: 1 × 8
    ##   estimate statistic     p.value parameter conf.low conf.high method alternative
    ##      <dbl>     <dbl>       <dbl>     <int>    <dbl>     <dbl> <chr>  <chr>      
    ## 1    0.605      32.3     1.33e-8         1    0.569     0.640 1-sam… two.sided  
    ## 
    ## [[28]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.361      85.1 2.87e-20         1    0.333     0.391 1-sample… two.sided  
    ## 
    ## [[29]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.511     0.134   0.714         1    0.459     0.563 1-sample … two.sided  
    ## 
    ## [[30]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.362      57.5 3.39e-14         1    0.329     0.398 1-sample… two.sided  
    ## 
    ## [[31]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.649      126. 3.14e-29         1    0.623     0.673 1-sample… two.sided  
    ## 
    ## [[32]]
    ## # A tibble: 1 × 8
    ##   estimate statistic     p.value parameter conf.low conf.high method alternative
    ##      <dbl>     <dbl>       <dbl>     <int>    <dbl>     <dbl> <chr>  <chr>      
    ## 1    0.388      31.3     2.26e-8         1    0.349     0.427 1-sam… two.sided  
    ## 
    ## [[33]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.536      4.88  0.0271         1    0.504     0.569 1-sample … two.sided  
    ## 
    ## [[34]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.485     0.537   0.464         1    0.447     0.524 1-sample … two.sided  
    ## 
    ## [[35]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.413      12.0 0.000538         1    0.365     0.463 1-sample… two.sided  
    ## 
    ## [[36]]
    ## # A tibble: 1 × 8
    ##   estimate statistic     p.value parameter conf.low conf.high method alternative
    ##      <dbl>     <dbl>       <dbl>     <int>    <dbl>     <dbl> <chr>  <chr>      
    ## 1    0.448      32.9     9.80e-9         1    0.430     0.466 1-sam… two.sided  
    ## 
    ## [[37]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.551      9.46 0.00210         1    0.518     0.584 1-sample … two.sided  
    ## 
    ## [[38]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.534      2.80  0.0945         1    0.494     0.573 1-sample … two.sided  
    ## 
    ## [[39]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.263      95.1 1.80e-22         1    0.223     0.308 1-sample… two.sided  
    ## 
    ## [[40]]
    ## # A tibble: 1 × 8
    ##   estimate statistic     p.value parameter conf.low conf.high method alternative
    ##      <dbl>     <dbl>       <dbl>     <int>    <dbl>     <dbl> <chr>  <chr>      
    ## 1    0.370      25.0 0.000000566         1    0.321     0.421 1-sam… two.sided  
    ## 
    ## [[41]]
    ## # A tibble: 1 × 8
    ##   estimate statistic   p.value parameter conf.low conf.high method   alternative
    ##      <dbl>     <dbl>     <dbl>     <int>    <dbl>     <dbl> <chr>    <chr>      
    ## 1    0.429      16.7 0.0000434         1    0.395     0.463 1-sampl… two.sided  
    ## 
    ## [[42]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.618      14.9 0.000114         1    0.558     0.675 1-sample… two.sided  
    ## 
    ## [[43]]
    ## # A tibble: 1 × 8
    ##   estimate statistic     p.value parameter conf.low conf.high method alternative
    ##      <dbl>     <dbl>       <dbl>     <int>    <dbl>     <dbl> <chr>  <chr>      
    ## 1    0.380      26.2 0.000000300         1    0.335     0.426 1-sam… two.sided  
    ## 
    ## [[44]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.507    0.0965   0.756         1    0.468     0.545 1-sample … two.sided  
    ## 
    ## [[45]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.467     0.915   0.339         1    0.404     0.532 1-sample … two.sided  
    ## 
    ## [[46]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.540      10.4 0.00127         1    0.515     0.564 1-sample … two.sided  
    ## 
    ## [[47]]
    ## # A tibble: 1 × 8
    ##   estimate statistic   p.value parameter conf.low conf.high method   alternative
    ##      <dbl>     <dbl>     <dbl>     <int>    <dbl>     <dbl> <chr>    <chr>      
    ## 1    0.599      17.0 0.0000365         1    0.552     0.645 1-sampl… two.sided  
    ## 
    ## [[48]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1    0.457      1.39   0.239         1    0.388     0.527 1-sample … two.sided  
    ## 
    ## [[49]]
    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1        0         0       1         1        0     0.945 1-sample … two.sided  
    ## 
    ## [[50]]
    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method    alternative
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>     <chr>      
    ## 1    0.331      65.9 4.76e-16         1    0.293     0.371 1-sample… two.sided  
    ## 
    ## [[51]]
    ## # A tibble: 1 × 8
    ##   estimate statistic    p.value parameter conf.low conf.high method  alternative
    ##      <dbl>     <dbl>      <dbl>     <int>    <dbl>     <dbl> <chr>   <chr>      
    ## 1    0.438      20.5 0.00000600         1    0.411     0.465 1-samp… two.sided
